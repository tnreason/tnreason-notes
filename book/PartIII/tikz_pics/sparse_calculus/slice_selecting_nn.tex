\begin{tikzpicture}[thick, scale=0.35] % , baseline = -3.5pt

    \begin{scope}
        [shift={(0,-6)}]
        \draw[] (0,1)--(0,-1) node[midway,left] {\colorlabelsize $\catvariableof{0}$};
        \draw[] (1.5,1)--(1.5,-1) node[midway,left] {\colorlabelsize $\catvariableof{1}$};
        \node[anchor=center] (text) at (3,0) {$\cdots$};
        \draw[] (4,1)--(4,-1) node[midway,right] {\colorlabelsize $\catvariableof{\atomorder\shortminus1}$};
    \end{scope}

    \draw (-1,1) rectangle (5, -5);
    \node[anchor=center] (text) at (2,-2) {$\fselectionmap$};

    \draw[] (5,0.5) -- (7,0.5) node[midway, above] {\colorlabelsize $\selvariableof{0,0}$};
    \draw[] (5,-1)--(7,-1) node[midway,above] {\colorlabelsize $\selvariableof{0,1}$};
    \node[anchor=center] (text) at (6,-1.75) {$\vdots$};
    \draw[] (5,-3)--(7,-3) node[midway,below] {\colorlabelsize $\selvariableof{\sliceorder\shortminus1,0}$};
    \draw[] (5,-4.5)--(7,-4.5) node[midway,below] {\colorlabelsize $\selvariableof{\sliceorder\shortminus1,1}$};

    \draw (7,1) rectangle (9, -5);
    \node[anchor=center] (text) at (8,-2) {$\canparam$};

    \node[anchor=center] (text) at (12,-2) {${=}$};

    \begin{scope}
        [shift={(17,8)}]

        \begin{scope}
            [shift={(0,-10)}]

            \draw (-1,7) rectangle (12, 9);
            \node[anchor=center] (text) at (5.5,8) {$\land$};

            % First leg selector
            \draw (1,6) -- (1,7);
            \drawvariabledot{1}{6}
            \draw[->-] (1,5) -- (1,6) node[midway, right] {\colorlabelsize $\headvariableof{\lneuron_0}$};
            \draw (-1,3) rectangle (3, 5);
            \node[anchor=center] (text) at (1,4) {$\bencodingof{\{\notucon,\iducon,\trueucon\}}$};

            \draw (3,4) -- (12,4);
            \draw[-<-] (12,4) -- (14,4) node[midway, above] {\colorlabelsize $\selvariableof{0,0}$};

            % SelectorCores
            \draw[->-] (1,1) -- (1,3) node[midway, left] {\colorlabelsize $\headvariableof{\vselectionsymbol,0}$};

            \draw (-1,1) rectangle (3, -1);
            \node[anchor=center] (text) at (1,0) {$\selectorcoreof{0}$};
            \draw (3,0) to[bend left=10]  (12,2.5);
            \draw[-<-] (12,2.5) -- (14,2.5) node[midway, above] {\colorlabelsize $\selvariableof{0,1}$};

            \draw[-<-] (0,-1)--(0,-3) node[midway,left] {\colorlabelsize $\catvariableof{0}$};
            \node[anchor=center] (text) at (1,-2) {$\cdots$};
            \draw[-<-] (2,-1)--(2,-3) node[midway,right] {\colorlabelsize $\catvariableof{\atomorder\shortminus1}$};

            \node[anchor=center] (text) at (5.5,0) {$\cdots$};

            % Second leg selector
            \draw (10,5) --(10,7);
            \drawvariabledot{10}{6}
            \draw[->-] (10,1) -- (10,5) node[midway, right] {\colorlabelsize $\headvariableof{\lneuron_{\sliceorder\shortminus 1}}$};
            \draw (8,-1) rectangle (12, 1);
            \node[anchor=center] (text) at (10,0) {$\bencodingof{\{\notucon,\iducon,\trueucon\}}$};
            \draw[-<-] (12,0) -- (14,0) node[midway, below] {\colorlabelsize $\selvariableof{\sliceorder\shortminus1,0}$};

            \draw[->-] (10,-3) -- (10,-1) node[midway, left] {\colorlabelsize $\headvariableof{\vselectionsymbol,\sliceorder\shortminus1}$};
            \draw (8,-5) rectangle (12, -3);
            \node[anchor=center] (text) at (10,-4) {$\selectorcoreof{\sliceorder-1}$};
            \draw[-<-] (12,-4) -- (14,-4) node[midway, below] {\colorlabelsize $\selvariableof{\sliceorder\shortminus1,1}$};

            % ParameterCores
            \draw (14,4) -- (15,4);
            \drawvariabledot{14}{4}
            \draw (14,2.5) -- (15,2.5);
            \drawvariabledot{14}{2.5}
            \draw (14,0) -- (15,0);
            \drawvariabledot{14}{0}
            \draw (14,-4) -- (15,-4);
            \drawvariabledot{14}{-4}
            \draw (15,5) rectangle (17, -5);
            \node[anchor=center] (text) at (16,0) {$\canparam$};

            \node[anchor=center] (text) at (13,1.5) {$\vdots$};

            \drawvariabledot{7.5}{-7}
            \drawvariabledot{3.5}{-7}

            \draw[] (3.5,-7) to[bend left=25] (0,-3);
            \draw[->-] (3.5,-7) to[bend right=10] (9,-5);

            \draw[] (7.5,-7) to[bend left=10] (2,-3);
            \draw[->-] (7.5,-7) to[bend right=25] (11,-5);

            \draw[->-] (3.5,-9)--(3.5,-7) node[midway,left] {\colorlabelsize $\catvariableof{0}$};
            \node[anchor=center] (text) at (5.5,-8) {$\cdots$};
            \draw[->-] (7.5,-9)--(7.5,-7) node[midway,right] {\colorlabelsize $\catvariableof{\atomorder\shortminus1}$};

        \end{scope}

    \end{scope}

\end{tikzpicture}