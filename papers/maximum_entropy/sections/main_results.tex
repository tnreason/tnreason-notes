\section{Main results: Tensor network representation of maximum entropy distributions}

Given the mean polytope discussion we now characterize the tensor network representation of maximum entropy distributions.



\subsection{Maximum entropy on the interior}

A classical result states, that the maximum entropy distribution is in the exponential family $\expfamilyof{\sstat,\basemeasure}$ (see e.g. \cite{koller_probabilistic_2009}).

\begin{theorem}
    \label{the:maxEntropyInterior}
    %If the only face $\genfacesetof{\facecondset}$ of $\genmeanset$ with $\meanparam\in\genfacesetof{\facecondset}$ is $\genmeanset$ itself
    If and only if $\genmean$ is in the relative interior of $\genmeanset$, then the unique solution of the maximum entropy problem is the distribution
    \begin{align*}
        \expdistofat{\sstat,\genmean,\basemeasure}{\shortcatvariables}\in\expfamilyof{\sstat,\basemeasure}
    \end{align*}
    with $\contractionof{\expdistofat{\sstat,\genmean,\basemeasure}{\shortcatvariables},\sencsstatwith}{\selvariable}=\genmeanat{\selvariable}$.
\end{theorem}
\begin{proof}
    By \lemref{lem:interiorRepExpFamily}
    \begin{align*}
        \meanparamwith \in \sbinteriorof{\genmeanset}  \, ,
    \end{align*}
    there is a canonical parameter $\canparam$ with
    \begin{align*}
        \contractionof{\expdistofat{\sstat,\canparam,\basemeasure}{\shortcatvariables},\sencsstatwith,\basemeasurewith}{\selvariable}=\meanparamat{\selvariable} \, .
    \end{align*}

    For any other feasible distribution $\secprobat{\shortcatvariables}$ we also have $\contractionof{\secprobat{\shortcatvariables},\sencsstatwith,\basemeasurewith}{\selvariable}=\meanparamat{\selvariable}$ and thus
    \begin{align*}
        \centropyofwrt{\secprobtensor}{\expdistof{(\sstat,\canparam,\basemeasure)}}{\basemeasure}
        &= -\contraction{\secprobtensor,\lnof{\expdistofat{(\sstat,\canparam,\basemeasure)}{\shortcatvariables}},\basemeasurewith} \\
        &= -\contraction{\secprobtensor,\sencsstatwith,\canparamwith,\basemeasurewith} + \cumfunctionof{\canparam} \\
        &= - \contraction{\canparamwith,\meanparamwith} + \cumfunctionof{\canparam} \\
        &= \sentropyofwrt{\expdistof{(\sstat,\canparam,\basemeasure)}}{\basemeasure} \, .
    \end{align*}
    With the Gibbs inequality we have if $\secprobtensor\neq\expdistof{(\sstat,\canparam,\basemeasure)}$
    \begin{align*}
        \sentropyofwrt{\expdistof{(\sstat,\estcanparam,\basemeasure)}}{\basemeasure}  - \sentropyofwrt{\secprobtensor}{\basemeasure}
        = \centropyofwrt{\secprobtensor}{\expdistof{(\sstat,\estcanparam,\basemeasure)}}{\basemeasure}  - \sentropyofwrt{\secprobtensor}{\basemeasure}  > 0 \,
    \end{align*}
    and thus $\sentropyofwrt{\secprobtensor}{\basemeasure}<\sentropyofwrt{\secprobtensor}{\basemeasure}$.
    Therefore, if $\secprobtensor$ does not coincide with $\expdistof{(\sstat,\estcanparam,\basemeasure)}$, it is not a maximum entropy distribution.
\end{proof}

%Exponential families are in $\elrealizabledistsof{\sstat}$, if and only if $\normalizationof{\basemeasure}{\shortcatvariables}\in\elrealizabledistsof{\sstat}$.
%If $\normalizationof{\basemeasure}{\shortcatvariables}\in\elrealizabledistsof{\sstat}$ and $\meanparamwith \in \sbinteriorof{\genmeanset} $ we therefore have a sparse representation of the maximum entropy distribution with elementary activation tensors.

\subsection{Main result}

Our main result generalizes the maximum entropy characterization of \theref{the:maxEntropyInterior} to arbitrary mean parameters.

\begin{theorem}[Generic characterization of Maximum Entropy Solutions]
    \label{the:MAINgenMaxEntChar}
    Let $\sstat$ be a statistic and $\basemeasure$ a base measure.
    For any $\meanparamwith$ the maximum entropy problem has a feasible distribution, if and only if $\meanparamwith\in\genmeanset$.
    In case $\meanparamwith\in\genmeanset$ denote the unique face of $\genmeanset$ with $\meanparam$ in its relative interior by $\genfaceset$ (see \defref{def:relativeInterior}).
    Then the solution of the maximum entropy problem is the member
    \begin{align*}
        \expdistof{(\sstat,\backwardmapwrtof{\sstat,\genfacemeasure}{\meanparam},\genfacemeasure)}
    \end{align*}
    of the exponential family $\expfamilyof{\sstat,\genfacemeasure}$, where $\genfacemeasure$ is the face measure (see \defref{def:faceMeasure}).
    If for a hypergraph $\graph$, which nodes appear all in at least one edge, the face is representable with respect to $\graph$ (see \defref{def:faceRepresentability}), then the maximum entropy distribution is in $\realizabledistsof{\sstat,\graph,\basemeasure}$.
    %$\genfacemeasure\in\$ is an elementary \ComputationActivationNetwork{}, then $\expdistof{(\sstat,\backwardmapwrtof{\sstat,\genfacemeasure}{\meanparam},\genfacemeasure)}$ is a \ComputationActivationNetwork{} with respect to the CP graph of rank $\cprankof{\genfaceset}$.
\end{theorem}

Note, that while we use refined base measures $\genfacemeasure$ to characterize the maximum entropy distribution, \theref{the:MAINgenMaxEntChar} states a representation with respect to the original base measure $\basemeasure$.

To prepare for the proof of this theorem we first show in an auxiliary lemma that we can reduce the set of feasible distributions in \probref{prob:maxEntropy}.

\begin{lemma}
    \label{lem:maxEntReduction}
    For any $\meanparamwith\in\genmeanset$ and a face $\genfaceset$ with $\meanparamwith\in\sbinteriorof{\genfaceset}$ we have that the solutions of $\mathrm{P}_{\sstat,\meanparam,\basemeasure}$ and $\mathrm{P}_{\sstat,\meanparam,\genfacemeasure}$ coincide.
\end{lemma}
\begin{proof}
    By \lemref{lem:faceMeasureRepCondition} all feasible distributions are representable by the with the face measure refined base measure.
    We have that any for $\mathrm{P}_{\sstat,\meanparam,\basemeasure}$ feasible distribution $\probwith$ satisfies
    \begin{align*}
        \contraction{\probwith,\genfacemeasure} = 1 \,
    \end{align*}
    and thus $\probwith\in\realizabledistsof{\sstat,\genfacemeasure}$.
    Conversely, any $\probwith\in\realizabledistsof{\sstat,\genfacemeasure}$ satisfies
    \begin{align*}
        \contraction{\probwith,\genfacemeasure} = \contraction{\probwith,\basemeasure} = 1
    \end{align*}
    and thus $\probwith\in\realizabledistsof{\sstat,\basemeasure}$.
    Problem $\mathrm{P}_{\sstat,\meanparam,\basemeasure}$ is thus equal to
    \begin{align*}
        \argmax_{\probwith\in\realizabledistsof{\sstat,\genfacemeasure}} \sentropyofwrt{\probwith}{\basemeasure}
        \stspace
        \forall_{\selindexin} \wcols
        \contractionof{\probwith,\sstatcoordinateofat{\selindex}{\shortcatvariables},\basemeasurewith}{\selvariable} = \genmeanat{\indexedselvariable}
    \end{align*}
    We further have that any $\probwith\in\realizabledistsof{\sstat,\genfacemeasure}$
    \begin{align*}
        \sentropyofwrt{\probwith}{\basemeasure} = \sentropyofwrt{\probwith}{\genfacemeasure}
    \end{align*}
    and arrive together with the above equivalence at the claim.
\end{proof}


\begin{proof}[Proof of \theref{the:MAINgenMaxEntChar}]
    \textbf{Feasibility Claim:}
    If and only if $\meanparamwith\in\genmeanset$ then there is by definition a by $\basemeasure$ representable $\probwith$ reproducing $\meanparamwith$.
    Thus if and only if $\meanparamwith\in\genmeanset$ there is a feasible distribution for the maximum entropy problem. \\

    \textbf{Characterization Claim:}
    We use the following argumentation to show the second claim:
    \begin{itemize}
        \item By \lemref{lem:relativeInteriorPolytopePartition} for any $\meanparam$ we find a unique face $\genfaceset$.
        \item By \lemref{lem:maxEntReduction} we can reduce the maximum entropy problem \probref{prob:maxEntropy} to $\mathrm{P}_{\sstat,\meanparam,\genfacemeasure}$ to the base measure $\genfacemeasure$.
        \item By \lemref{lem:faceAsRefinedPolytope} the face $\genfaceset$ coincides with the polytope $\meansetof{\sstat,\genfacemeasure}$ and in particular $\meanparam$ is in the relative interior of that polytope.
        \item We can now apply \theref{the:maxEntropyInterior} and get a characterization of the maximum entropy solution as a member of the exponential family.
    \end{itemize}

    \textbf{Representation Claim:} % ! WE DO A CHANGE OF BASE MEASURE HERE
    By \defref{def:faceRepresentability} we find a tensor network $\extnet$ on $\graph$ representing the face measure, that is
    \begin{align*}
        \genfacemeasurewith = \contractionof{\{\extnet\}\cup\{\bencsstatwith,\basemeasurewith\}}{\shortcatvariables} \, .
    \end{align*}
    We now contract the activation vectors of the exponential family on this tensor network (see \figref{fig:maxEntropyActcore}).
    To this end we choose a hyperedge $\edge(\selindex)$ to each node $\selindexin$, which is possible by assumption, and define a tensor network $\tilde{\tnet}^{\graph}$ by core tensors
    \begin{align*}
        \sechypercoreofat{\edge}{\headvariableof{\edge}} = \contractionof{\{\hypercoreofat{\edge}{\headvariableof{\edge}}\}\cup\{\softactlegat{\headvariableof{\selindex}}\wcols\edge=\edge(\selindex)\}}{\edgevariables} \, .
    \end{align*}
    Now we have that
    \begin{align*}
        \contractionof{\{\tilde{\tnet}^{\graph}\}\cup\{\bencsstatwith,\basemeasurewith\}}{\shortcatvariables}
        = \contractionof{\softacttensorat{\headvariables},\bencsstatwith,\genfacemeasurewith}{\shortcatvariables}
    \end{align*}
    Thus, the activation tensor network $\tilde{\tnet}^{\graph}$ represents the maximum entropy distribution $\probof{\sstat,\meanparam,\basemeasure}$ in the family $\realizabledistsof{\sstat,\graph,\basemeasure}$ of \ComputationActivationNetworks{}.
\end{proof}

\begin{figure}[t]
    \begin{center}
        \input{../../PartI/tikz_pics/probability_reasoning/max_entropy_actcore}
    \end{center}
    \caption{
        Tensor network decomposition of maximum entropy distributions to the constraint $\meanparamat{\selvariable}=\contractionof{\probtensor,\sencsstat}{\selvariable}$.
        Blue: Constraint activation cores $\hardactsymbolof{\selindex}$ in a $\cpformat$ decomposition, representing the face measure to the minimal face, such that $\meanparam\in\genfacesetof{\facecondset}$.
        Red: Probabilistic activation cores $\softactlegwith$ in an elementary decomposition, where each leg core is a scaled exponentials evaluated on the enumerated image $\imageof{\sstatcoordinateof{\selindex}}$.
    }\label{fig:maxEntropyActcore}
\end{figure}

\subsection{Family of maximum entropy distributions}

The family of maximum entropy distributions is the set
\begin{align*}
    \{\probof{\sstat,\meanparam,\basemeasure} \wcols \meanparam\in\genmeanset\ncond \probof{\sstat,\meanparam,\basemeasure} \quad\text{is a solution of }\quad \probref{prob:maxEntropy}\} \, .
\end{align*}

By \theref{the:expFamilyTensorRep} this is the union of exponential families to each face measure.
Note that these families are disjoint, since each member of an exponential family has support by the support of the face measure.