\section{Notation}

We present the basic notation of quantum circuits using the tensor network notation used in the \tnreason{} formalism.

\subsection{Comparing tensor networks and quantum circuits}

First of all, we need to extend to complex tensors, which are maps
\begin{align*}
    \hypercore : \atomstates \rightarrow \mathbb{C} \,
\end{align*}
with image in $\mathbb{C}$ instead of $\mathbb{R}$ as in the report.

A coarse comparison of the nomenclature used for quantum circuits and tensor networks:

\begin{center}
    \begin{tabular}{l|l}
        \textbf{Quantum Circuit} & \textbf{Tensor Network}                         \\
        \hline
        Qubit                    & Boolean Variable                                \\
        Quantum Gate             & Unitary Tensor                                  \\
        Quantum Circuit          & Tensor Network of unitaries on a directed graph
    \end{tabular}
\end{center}

Some constraints appear for a tensor network to be a quantum circuit
\begin{itemize}
    \item \textbf{Incoming-Outgoing structure:} Variable appear at most once as incoming and at most once as outgoing variables.
    Those not appearing as outgoing (respectively as incoming) are the input and the output variables of the whole circuit.
    \item \textbf{Unitarity of each gate:} That is the variables of each tensor are bipartite into sets $\variablesetof{\insymbol}$ and $\variablesetof{\outsymbol}$ of same cardinality and the basis encoding with respect to this bipartition, that is
    \begin{align*}
        T_{\insymbol \rightarrow \outsymbol}[\catvariableof{\insymbol},\catvariableof{\outsymbol}] : \bigotimes_{\atomenumerator\in\variablesetof{\insymbol}} \mathbb{C}^2 \rightarrow \bigotimes_{\atomenumerator\in\variablesetof{\outsymbol}} \mathbb{C}^2  \, ,
    \end{align*}
    is a unitary map, that is
    \begin{align*}
        \left(T_{\insymbol \rightarrow \outsymbol}\right)^H \circ \left(T_{\insymbol \rightarrow \outsymbol}\right)
        = \contractionof{
            T_{\insymbol \rightarrow \outsymbol}[\catvariableof{\insymbol},\seccatvariable],
            \overline{T}_{\insymbol \rightarrow \outsymbol}[\seccatvariable,\catvariableof{\outsymbol}]
        }{\catvariableof{\outsymbol},\catvariableof{\insymbol}}
        = \identityat{\catvariableof{\outsymbol},\catvariableof{\insymbol}}.
    \end{align*}
    \item \textbf{Acyclicity:} Incoming and outgoing variables of each tensor core provide a direction of each edge tensor.
    With respect to this directionality the graph underlying the tensor network has to be acyclic.
\end{itemize}

The unitary tensors can be aligned layerwise, if and only if the last two assumption hold, i.e. the directed graph is acyclic and each variable appears at most once as an incoming and at most once as an outgoing variable.


\subsection{Controlled Single Qubit Gates}

We define the rotation gate around the Y-axis by an angle $\alpha$ as
\begin{align*}
    \yrotationofat{\alpha}{\cavariable{\insymbol},\cavariable{\outsymbol}} \coloneqq
    \begin{bmatrix}
        \cosof{\frac{\alpha}{2}} & -\sinof{\frac{\alpha}{2}} \\
        \sinof{\frac{\alpha}{2}} & \cosof{\frac{\alpha}{2}}
    \end{bmatrix}
\end{align*}

Further we define the Pauli-X:
\begin{align*}
    \paulixat{\cavariable{\insymbol},\cavariable{\outsymbol}} \coloneqq
    \begin{bmatrix}
        0 & 1 \\
        1 & 0
    \end{bmatrix}
\end{align*}

%% Control notation
Controlled single qubit gates are defined using control qubits, where the gate is applied to the target qubit if the control qubits are in a specific state and the identity is applied otherwise.
In the tensor network diagrams, we do not distinguish between incoming and outgoing control qubit variables, since the control acts as a Dirac tensor.
Thus, controlled unitary with target qubit $\catvariableof{t}$ and control qubits $\catvariableof{c}$ are represented by tensors
\begin{align*}
    \contunitaryat{\catvariableof{t,\insymbol},\catvariableof{t,\outsymbol},\catvariableof{c}}
\end{align*}
where for each state $\catindexof{c}$ to the control variables we have that
\begin{align*}
    \contunitaryat{\catvariableof{t,\insymbol},\catvariableof{t,\outsymbol},\indexedcatvariableof{c}}
\end{align*}
is a unitary matrix acting on the leg space of the target variable.

\subsection{Measurements and Contractions}

\subsubsection{Direct measurement}

The computational basis measurement of the qubits $\catvariableof{\variableset}$ of a Quantum State $\qstatewith$ is equal to drawing samples from a distribution
\begin{align*}
    \probat{\catvariableof{\variableset}} = \contractionof{
        \qstatewith, \comconqstatewith
    }{\catvariableof{\variableset}} \, .
\end{align*}
Here $\comconqstatewith$ is the complex conjugate of $\qstatewith$.
When $\qstate$ is prepared by a quantum circuit acting on a initial state, the complex conjugate is the hermitean conjugate of the circuit acting on the complex conjgate of the initial state.

%% Add drawing!
We abbreviate these contractions by extending the contraction diagrams with measurement symbols (see \figref{fig:measurementSketch}).
\begin{figure}
    \begin{center}
        \input{tikz_pics/directed_measurement_sketch.tikz}
    \end{center}
    \caption{Computational Basis Measurement of a quantum state $\qstate$.
    The measurement symbols on the left side indicate the measured qubits and the first equation is understood as a definition.
    In the second equation we sketch, that the measurement distribution is equal to the contraction of the square absolute transform of $\qstate$ to the measured variables.
    }\label{fig:measurementSketch}
\end{figure}

%% Phase-Absolut decomposition
Each complex-valued tensor $\qstatewith$ has a decomposition into a phase tensor $\phasecorewith$ and an absolute tensor $\absof{\qstate}[\shortcatvariables]$ defined by
\begin{align*}
    \qstatewith = \contractionof{\expof{i\cdot\phasecorewith}, \absof{\qstatewith}}{\shortcatvariables}\, .
\end{align*}

The measurement distribution is depends only on $\absof{\phi}$, that is
\begin{align*}
    \probwith = \absof{\qstatewith}^2 \, .
\end{align*}
Note, that this measurement distribution is not sensitive to the phases of the amplitudes.

When only a subset of variables is measured, the distribution is the contraction of the absolute square transform (these operations do not commute)
\begin{align*}
    \probat{\catvariableof{\secnodes}}
    = \contractionof{\absof{\qstatewith}^2}{\catvariableof{\secnodes}} \, .
\end{align*}

%% Phasecore vanishing as gauging
When we are interested in the preparation of quantum states with a specific computational basis measurement distribution, we can restrict to states with vanishing phase cores, that is
\begin{align*}
    \qstatewith
    = \contractionof{\expof{i\cdot\zerosat{\shortcatvariables}}, \absof{\qstate}[\shortcatvariables]}{\shortcatvariables}
    = \absof{\qstate}[\shortcatvariables]  \, .
\end{align*}

\subsubsection{Phase sensitive measurement}

When applying a Walsh-Hadamard transform on the qubits $\nodes\backslash\secnodes$ to be closed (see \figref{fig:phaseContractionMeasurement}), the probability of measuring the closed qubits in the ground state is %we perform the contraction
\begin{align*}
    \probat{\catvariableof{\nodes\backslash\secnodes}=0_{\nodes\backslash\secnodes},\catvariableof{\secnodes}}
    = \frac{1}{2^{\cardof{\secnodes}}} \cdot \absof{\contractionof{\qstatewith}{\catvariableof{\secnodes}}}^2 \, .
\end{align*}
We thus sample from the contracted quantum state.
Note that in this way, the relative phases of the amplitudes are contracted before the absolutes are taken.
In this way, the measurement distribution is sensitive to the relative phases.
This property is exploited in the Deutsch-Jozsa algorithm, which utilizes signs of the amplitudes.

\begin{figure}
    \begin{center}
        \input{tikz_pics/phase_contraction_measurement.tikz}
    \end{center}
    \caption{Computational Basis Measurement of a quantum state $\qstate$, after the Walsh-Hadamard Transform on the closed qubits.
    By the ellipse we indicate a coordinatewise transform to the square of the absolute, after the contraction.}
    \label{fig:phaseContractionMeasurement}
\end{figure}


\subsubsection{POVM measurements}

The main difficulty of using quantum circuits as contraction providers is that we can only extract information through measurements.
Therefore measurement is the only way to execute contractions of the circuit, which come with restrictions when interested in contraction with open variables.

The most general measurement formalism is through a POVM, a set $\{E_\seccatindex \, : \, \seccatindex\in[r]\}$ of positive operators with % Nielsen book notation
\begin{align*}
    \sum_{\seccatindex\in[r]} E_\seccatindex = I
\end{align*}

Measuring a pure state $\ket{\psi}$ We then get outcome $m$ with probability
\begin{align*}
    \braket{\psi|E_\seccatindex|\psi}
\end{align*}

We define a measurement variable $\headvariable$ taking indices $\seccatindex\in[r]$ and a measurement tensor
\begin{align*}
    E[\headvariable,\catvariableof{\insymbol},\catvariableof{\outsymbol}]
\end{align*}
with slices
\begin{align*}
    E[\headvariable=\seccatindex,\catvariableof{\insymbol},\catvariableof{\outsymbol}] = E_\seccatindex \, .
\end{align*}

Repeating the measurement asymptotically on a state $\ket{\psi}$ prepared by a quantum circuit $\tnetof{\graph}$ acting on the trivial start state $\ones$, we denote the measurement outcome by $\seccatindex^\datindex$.
In the limit $\datanum\rightarrow\infty$ we get almost surely
%    we thus get the contraction
\begin{align*}
    \frac{1}{\datanum} \sum_{\datindexin} \onehotmapofat{\seccatindex^\datindex}{\headvariable} \rightarrow
    \contractionof{\tnetof{\graph}[\catvariableof{\insymbol}],E[\headvariable,\catvariableof{\insymbol},\catvariableof{\outsymbol}],\tnetof{\secgraph}[\catvariableof{\outsymbol}]}{\headvariable} \, .
\end{align*}

% Case of computational basis measurements
POVMs to computational basis measurements of subsets of qubits are constructed as products with delta tensors on the non-measured qubits.